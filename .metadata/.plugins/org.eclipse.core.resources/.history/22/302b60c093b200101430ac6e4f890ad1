package com.jsp.driver;

import java.util.Scanner;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.EntityTransaction;
import javax.persistence.Persistence;

import com.jsp.entity.Student;

public class InsertStudent {

    public static void main(String[] args) {

        // Create a Scanner object to take input from user
        Scanner sc = new Scanner(System.in);

        // Taking user input
        System.out.print("Enter Student ID: ");
        int id = sc.nextInt();

        System.out.print("Enter Student Name: ");
        String name = sc.next();

        System.out.print("Enter Student Age: ");
        int age = sc.nextInt();

        // Closing scanner (good practice)
        sc.close();

        // Creating EntityManagerFactory object (linked to persistence.xml)
        EntityManagerFactory entityManagerFactory = Persistence.createEntityManagerFactory("sachin");

        // Creating EntityManager (responsible for interacting with the database)
        EntityManager entityManager = entityManagerFactory.createEntityManager();

        // Getting transaction object (used to perform DB operations safely)
        EntityTransaction entityTransaction = entityManager.getTransaction();

        // Starting transaction
        entityTransaction.begin();

        // Creating Student object using user input
        Student student = new Student(id, name, age);

        // Saving the object (this will insert a record into the DB)
        entityManager.persist(student);

        // Committing transaction (finalizing changes in DB)
        entityTransaction.commit();

        // Closing entity manager and factory
        entityManager.close();
        entityManagerFactory.close();

        System.out.println("âœ… Student inserted successfully!");
    }
}
